<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html>
	<head>
		<link rel="stylesheet" type="text/css" href="http://www.codeworker.org/CodeWorker.css" />
	</head>
	<body class="script">
		<pre><span class="comment">// Special manipulation if we are going to write a new paragraph</span>
<a class = "instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#function">function</a> handleBeginningOfParagraph(bBeginningOfParagraph : <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#function_parameters">node</a>) {
    <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#if">if</A> bBeginningOfParagraph {
        <span class="raw_text">@</span><span class="raw_text">&lt;text:p text:style-name=&quot;P1&quot;&gt;@</span>
        <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#bBeginningOfParagraph">bBeginningOfParagraph</A> = <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#boolean_literals">false</a>;
    }
}

<i>TrafficLight2OASIS</i> <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_BNF_syntax">::=</a>
    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {
        <span class="comment">// Invariant part of the document, such as styles</span>
        <span class="raw_text">@</span><span class="raw_text">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;office:document-content xmlns:office=&quot;urn:oasis:names:tc:opendocument:xmlns:office:1.0&quot; xmlns:style=&quot;urn:oasis:names:tc:opendocument:xmlns:style:1.0&quot; xmlns:text=&quot;urn:oasis:names:tc:opendocument:xmlns:text:1.0&quot; xmlns:table=&quot;urn:oasis:names:tc:opendocument:xmlns:table:1.0&quot; xmlns:draw=&quot;urn:oasis:names:tc:opendocument:xmlns:drawing:1.0&quot; xmlns:fo=&quot;urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0&quot; xmlns:xlink=&quot;http://www.w3.org/1999/xlink&quot; xmlns:dc=&quot;http://purl.org/dc/elements/1.1/&quot; xmlns:meta=&quot;urn:oasis:names:tc:opendocument:xmlns:meta:1.0&quot; xmlns:number=&quot;urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0&quot; xmlns:svg=&quot;urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0&quot; xmlns:chart=&quot;urn:oasis:names:tc:opendocument:xmlns:chart:1.0&quot; xmlns:dr3d=&quot;urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0&quot; xmlns:math=&quot;http://www.w3.org/1998/Math/MathML&quot; xmlns:form=&quot;urn:oasis:names:tc:opendocument:xmlns:form:1.0&quot; xmlns:script=&quot;urn:oasis:names:tc:opendocument:xmlns:script:1.0&quot; xmlns:ooo=&quot;http://openoffice.org/2004/office&quot; xmlns:ooow=&quot;http://openoffice.org/2004/writer&quot; xmlns:oooc=&quot;http://openoffice.org/2004/calc&quot; xmlns:dom=&quot;http://www.w3.org/2001/xml-events&quot; xmlns:xforms=&quot;http://www.w3.org/2002/xforms&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; office:version=&quot;1.0&quot;&gt;&lt;office:scripts/&gt;&lt;office:font-face-decls&gt;&lt;style:font-face style:name=&quot;Tahoma1&quot; svg:font-family=&quot;Tahoma&quot;/&gt;&lt;style:font-face style:name=&quot;Courier New&quot; svg:font-family=&quot;&amp;apos;Courier New&amp;apos;&quot; style:font-family-generic=&quot;modern&quot; style:font-pitch=&quot;fixed&quot;/&gt;&lt;style:font-face style:name=&quot;Lucida Sans Unicode&quot; svg:font-family=&quot;&amp;apos;Lucida Sans Unicode&amp;apos;&quot; style:font-pitch=&quot;variable&quot;/&gt;&lt;style:font-face style:name=&quot;Tahoma&quot; svg:font-family=&quot;Tahoma&quot; style:font-pitch=&quot;variable&quot;/&gt;&lt;style:font-face style:name=&quot;Times New Roman&quot; svg:font-family=&quot;&amp;apos;Times New Roman&amp;apos;&quot; style:font-family-generic=&quot;roman&quot; style:font-pitch=&quot;variable&quot;/&gt;&lt;/office:font-face-decls&gt;&lt;office:automatic-styles&gt;&lt;style:style style:name=&quot;P1&quot; style:family=&quot;paragraph&quot; style:parent-style-name=&quot;Standard&quot;&gt;&lt;style:paragraph-properties style:text-autospace=&quot;none&quot;/&gt;&lt;style:text-properties style:font-name=&quot;Courier New&quot; fo:font-size=&quot;10pt&quot; style:font-size-asian=&quot;10pt&quot; style:font-size-complex=&quot;10pt&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;P2&quot; style:family=&quot;paragraph&quot; style:parent-style-name=&quot;Standard&quot;&gt;&lt;style:text-properties style:font-name=&quot;Courier New&quot; fo:font-size=&quot;10pt&quot; style:font-size-asian=&quot;10pt&quot; style:font-size-complex=&quot;10pt&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T1&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:color=&quot;#0000ff&quot; fo:font-weight=&quot;bold&quot; style:font-weight-asian=&quot;bold&quot; style:font-weight-complex=&quot;bold&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T2&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:font-style=&quot;italic&quot; style:font-style-asian=&quot;italic&quot; style:font-style-complex=&quot;italic&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T3&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:color=&quot;#0000ff&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T4&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:color=&quot;#008000&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T5&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:color=&quot;#0000ff&quot; style:text-position=&quot;sub 58%&quot; fo:font-size=&quot;12pt&quot; style:font-size-asian=&quot;12pt&quot; style:font-size-complex=&quot;12pt&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T6&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:color=&quot;#800000&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;T7&quot; style:family=&quot;text&quot;&gt;&lt;style:text-properties fo:color=&quot;#ff0000&quot; fo:font-weight=&quot;bold&quot; style:font-weight-asian=&quot;bold&quot; style:font-weight-complex=&quot;bold&quot;/&gt;&lt;/style:style&gt;&lt;style:style style:name=&quot;fr1&quot; style:family=&quot;graphic&quot; style:parent-style-name=&quot;Graphics&quot;&gt;&lt;style:graphic-properties style:mirror=&quot;none&quot; fo:clip=&quot;rect(0in 0in 0in 0in)&quot; draw:luminance=&quot;0%&quot; draw:contrast=&quot;0%&quot; draw:red=&quot;0%&quot; draw:green=&quot;0%&quot; draw:blue=&quot;0%&quot; draw:gamma=&quot;100%&quot; draw:color-inversion=&quot;false&quot; draw:image-opacity=&quot;100%&quot; draw:color-mode=&quot;standard&quot;/&gt;&lt;/style:style&gt;&lt;/office:automatic-styles&gt;&lt;office:body&gt;&lt;office:text&gt;&lt;office:forms form:automatic-focus=&quot;false&quot; form:apply-design-mode=&quot;false&quot;/&gt;&lt;text:sequence-decls&gt;&lt;text:sequence-decl text:display-outline-level=&quot;0&quot; text:name=&quot;Illustration&quot;/&gt;&lt;text:sequence-decl text:display-outline-level=&quot;0&quot; text:name=&quot;Table&quot;/&gt;&lt;text:sequence-decl text:display-outline-level=&quot;0&quot; text:name=&quot;Text&quot;/&gt;&lt;text:sequence-decl text:display-outline-level=&quot;0&quot; text:name=&quot;Drawing&quot;/&gt;&lt;/text:sequence-decls&gt;@</span>
    }
    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#local">local</A> bBeginningOfParagraph = <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#boolean_literals">true</a>;
    <span class="comment">// consume token by token</span>
    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a>
            <span class="comment">// an identifier: keyword or function of the language or sensor</span>
            <a class="directive" href="http://www.codeworker.org/manual_The_scripting_language.html#_readIdentifier">#readIdentifier</a>:sWord
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a>
                    <span class="comment">// a keyword</span>
                    <a class="directive" href="http://www.codeworker.org/manual_The_scripting_language.html#_check">#check</a>(sWord <a class = "instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#boolean_expression">in</a> {<span class="string">&quot;activate&quot;</span>, <span class="string">&quot;desactivate&quot;</span>, <span class="string">&quot;duration&quot;</span>, <span class="string">&quot;start&quot;</span>, <span class="string">&quot;strategy&quot;</span>})
                    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T1&quot;&gt;@</span>sWord<span class="raw_text">@</span><span class="raw_text">&lt;/text:span&gt;@</span>}
                <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
                    <span class="comment">// the sensor: &#39;hour&#39; is displayed in subscript</span>
                    <a class="directive" href="http://www.codeworker.org/manual_The_scripting_language.html#_check">#check</a>(sWord == <span class="string">&quot;vehicles_hour&quot;</span>)
                    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T3&quot;&gt;vehicles&lt;/text:span&gt;&lt;text:span text:style-name=&quot;T5&quot;&gt;hour&lt;/text:span&gt;@</span>}
                <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
                    <span class="comment">// a function</span>
                    <a class="directive" href="http://www.codeworker.org/manual_The_scripting_language.html#_check">#check</a>(sWord == <span class="string">&quot;time&quot;</span>)
                    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T3&quot;&gt;@</span>sWord<span class="raw_text">@</span><span class="raw_text">&lt;/text:span&gt;@</span>}
                <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
                    <span class="comment">// other</span>
                    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T2&quot;&gt;@</span>sWord<span class="raw_text">@</span><span class="raw_text">&lt;/text:span&gt;@</span>}<a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">
            ]</a>
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// a constant string</span>
            <a class="directive" href="http://www.codeworker.org/manual_The_scripting_language.html#_readCString">#readCString</a>:sText
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T6&quot;&gt;&amp;quot;@</span>sText.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#composeHTMLLikeString">composeHTMLLikeString</A>()<span class="raw_text">@</span><span class="raw_text">&amp;quot;&lt;/text:span&gt;@</span>}
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// symbols to highlight</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a><span class="string">&quot;=&gt;&quot;</span> <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a> <span class="string">&quot;-&gt;&quot;</span><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">]</a>:sSymbol
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T7&quot;&gt;@</span>sSymbol.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#composeHTMLLikeString">composeHTMLLikeString</A>()<span class="raw_text">@</span><span class="raw_text">&lt;/text:span&gt;@</span>}
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// multi-line comment</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_negation">!</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_negation">!</a><span class="string">&quot;/*&quot;</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#-_amp_gt_">-&gt;</a><span class="string">&quot;*/&quot;</span><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">]</a>:sComment
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T4&quot;&gt;@</span>sComment.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#composeHTMLLikeString">composeHTMLLikeString</A>()<span class="raw_text">@</span><span class="raw_text">&lt;/text:span&gt;@</span>}
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// inline comment</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_negation">!</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_negation">!</a><span class="string">&quot;//&quot;</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_complementary">~</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a><span class="string">&#39;\r&#39;</span><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">]?</a> <span class="string">&#39;\n&#39;</span><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">]</a><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">]*</a>:sComment
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:span text:style-name=&quot;T4&quot;&gt;@</span>sComment.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#composeHTMLLikeString">composeHTMLLikeString</A>()<span class="raw_text">@</span><span class="raw_text">&lt;/text:span&gt;@</span>}
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// special case: tabulation</span>
            <span class="string">&#39;\t&#39;</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {<span class="raw_text">@</span><span class="raw_text">&lt;text:tab /&gt;@</span>}
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// special case: end of paragraph</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">[</a><span class="string">&#39;\r&#39;</span><a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">]?</a> <span class="string">&#39;\n&#39;</span>
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {
                <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#if">if</A> bBeginningOfParagraph {
                    <span class="raw_text">@</span><span class="raw_text">&lt;text:p text:style-name=&quot;P1&quot;&gt;@</span>
                } <a class = "instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#if">else</a> {
                    <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#bBeginningOfParagraph">bBeginningOfParagraph</A> = <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#boolean_literals">true</a>;
                }
                <span class="raw_text">@</span><span class="raw_text">&lt;/text:p&gt;@</span>
            }
        <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#parsing_alternation">|</a>
            <span class="comment">// any other non-empty character</span>
            <a class="directive" href="http://www.codeworker.org/manual_The_scripting_language.html#_readChar">#readChar</a>:cChar
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> handleBeginningOfParagraph(bBeginningOfParagraph);
            <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a>{<span class="raw_text">@</span><span class="raw_text">@</span>cChar.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#composeHTMLLikeString">composeHTMLLikeString</A>()<span class="raw_text">@</span><span class="raw_text">@</span>}<a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_token_repeating_a_token">
    ]*</a>
    <a class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#BNF_operator__eq__amp_gt_">=&gt;</a> {
        <span class="comment">// may have a paragraph to close</span>
        <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#if">if</A> <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#boolean_expression">!</a>bBeginningOfParagraph {
            <span class="raw_text">@</span><span class="raw_text">&lt;/text:p&gt;@</span>
        }
        <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#local">local</A> sFileName = <A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#getShortFilename">getShortFilename</A>(<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#getInputFilename">getInputFilename</A>());
        <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#local">local</A> sPictureFile = sFileName.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#rsubString">rsubString</A>(<span class="numeric">4</span>) + <span class="string">&quot;.png&quot;</span>;
        <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#if">if</A> sFileName.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#endString">endString</A>(<span class="string">&quot;.tlc&quot;</span>) &amp;&amp; sPictureFile.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#existFile">existFile</A>() {
            <span class="comment">// reference the PNG diagram of the strategy in the document and</span>
            <span class="comment">// copy it to the directory devoted to pictures</span>
            <A class="procedure" href="http://www.codeworker.org/manual_The_scripting_language.html#copyFile">copyFile</A>(sPictureFile, <span class="string">&quot;OpenOffice2.0/Pictures/&quot;</span> + sPictureFile);
            <span class="raw_text">@</span><span class="raw_text">&lt;text:p text:style-name=&quot;P1&quot; /&gt;&lt;text:p text:style-name=&quot;P1&quot;&gt;@</span>
            <span class="raw_text">@</span><span class="raw_text">&lt;draw:frame draw:style-name=&quot;fr1&quot; draw:name=&quot;graphics1&quot; text:anchor-type=&quot;paragraph&quot; @</span>
            <span class="comment">// extract the width and height of the picture, loaded as a binary file:</span>
            <span class="comment">// each byte is represented by two hexadecimal digits</span>
            <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#local">local</A> sHexaDimensions = <A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#rightString">rightString</A>(<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#leftString">leftString</A>(<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#loadBinaryFile">loadBinaryFile</A>(sPictureFile), <span class="numeric">48</span>), <span class="numeric">16</span>);
            <A class="instruction" href="http://www.codeworker.org/manual_The_scripting_language.html#local">local</A> dheight = <a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#$">$</a><span class="numeric">6.9</span>*<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#hexaToDecimal">hexaToDecimal</A>(sHexaDimensions.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#rightString">rightString</A>(<span class="numeric">8</span>)) / <A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#hexaToDecimal">hexaToDecimal</A>(sHexaDimensions.<A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#leftString">leftString</A>(<span class="numeric">8</span>))<a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#$">$</a>;
            <span class="raw_text">@</span><span class="raw_text">svg:width=&quot;6.9in&quot; @</span>
            <span class="raw_text">@</span><span class="raw_text">svg:height=&quot;@</span><a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#$">$</a><A class="function" href="http://www.codeworker.org/manual_The_scripting_language.html#floor">floor</A>(<a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#$">$</a><span class="numeric">1</span> + dheight*<span class="numeric">10</span><a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#$">$</a>)/<span class="numeric">10</span><a class="constant" href="http://www.codeworker.org/manual_The_scripting_language.html#$">$</a><span class="raw_text">@</span><span class="raw_text">in&quot; @</span>
            <span class="raw_text">@</span><span class="raw_text">draw:z-index=&quot;0&quot;&gt;&lt;draw:image xlink:href=&quot;Pictures/@</span>sPictureFile<span class="raw_text">@</span><span class="raw_text">&quot; xlink:type=&quot;simple&quot;@</span>
            <span class="raw_text">@</span><span class="raw_text"> xlink:show=&quot;embed&quot; xlink:actuate=&quot;onLoad&quot;/&gt;&lt;/draw:frame&gt;&lt;/text:p&gt;@</span>
        }
        <span class="comment">// end of the document</span>
        <span class="raw_text">@</span><span class="raw_text">&lt;/office:text&gt;&lt;/office:body&gt;&lt;/office:document-content&gt;@</span>
    }
    ;

</pre><hr />
		Generated by <I class="CodeWorker">CodeWorker</I> v3.11.0.1 from <a href="http://www.codeworker.org/CWscript2HTML.html">CWscript2HTML.cwp</a>.
	</body>
</html>
